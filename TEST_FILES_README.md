# 测试文件说明

本目录包含 `orchestrator_v6.py` 系统测试所需的所有文件。

---

## 📁 文件清单

| 文件名 | 大小 | 用途 | 优先级 |
|--------|------|------|--------|
| **TEST_REPORT.md** | 13KB | 📊 测试结果记录表 | ⭐⭐⭐ 必读 |
| **TEST_GUIDE.md** | 9.4KB | 📖 测试执行指南 | ⭐⭐⭐ 必读 |
| **DEVELOPER_SUMMARY.md** | 8.0KB | 📝 Developer 工作总结 | ⭐⭐ 推荐 |
| **claude-progress03.md** | 5.2KB | 📈 项目进度记录 | ⭐⭐ 推荐 |
| task-dev.md | 38B | 🧪 测试资源（场景6用） | ⭐ 可选 |
| task-test.md | 32B | 🧪 测试资源（场景6用） | ⭐ 可选 |

---

## 🚀 快速开始

### 第一次执行测试？

**步骤1**: 阅读测试指南
```bash
cat TEST_GUIDE.md
```

**步骤2**: 执行 P0 测试（最高优先级）
```bash
# 场景2: 验证多轮循环机制
python src/orchestrator_v6.py
# 选择: 模式3, 2轮, 复杂度2

# 场景4: 验证 Architect 权限
python src/orchestrator_v6.py
# 选择: 模式1, 1轮
```

**步骤3**: 记录结果
```bash
vim TEST_REPORT.md
# 填写验证清单和测试结果
```

---

## 📋 测试场景优先级

### ⚠️ P0 - 必须验证（核心功能）

| 场景 | 预估时间 | Token 预算 | 关键验证 |
|------|----------|------------|---------|
| **场景2** | 20-30分钟 | 50k-100k | 多轮循环机制 |
| **场景4** | 15-20分钟 | 30k-50k | Architect 权限隔离 |

### ⚠️ P1 - 推荐验证（重要功能）

| 场景 | 预估时间 | Token 预算 | 关键验证 |
|------|----------|------------|---------|
| **场景3** | 10-15分钟 | 20k-40k | 分支创建 |

### ℹ️ P2 - 可选验证（高级特性）

| 场景 | 预估时间 | Token 预算 | 关键验证 |
|------|----------|------------|---------|
| 场景1 | 5-10分钟 | 10k-20k | 基础功能 |
| 场景5 | 10-15分钟 | 20k-40k | 多Agent并行 |
| 场景6 | 10-15分钟 | 20k-40k | .md文件支持 |
| 场景7 | 15-20分钟 | 20k-40k | 恢复中断 |

**建议**: 优先完成 P0 和 P1 验证，确保核心功能正常。

---

## 📖 文件详细说明

### TEST_REPORT.md - 测试报告模板

**内容**:
- 7个测试场景的完整验证清单
- P0/P1/P2 Bug 验证表格
- 测试结果记录区域
- 问题记录模板
- 测试总结模板

**使用方式**:
1. 执行每个场景测试
2. 勾选验证清单 `[ ]` → `[x]`
3. 粘贴关键输出到 "输出截图/日志" 区域
4. 记录发现的问题
5. 更新测试状态：⏳ 待测 / ✅ 通过 / ❌ 失败

**示例**:
```markdown
#### 验证清单
| 验证点 | 状态 | 备注 |
|--------|------|------|
| 自动创建 feature 分支 | ✅ 通过 | 分支名: feature/dev-001 |
| 执行全部6个agents | ✅ 通过 | architect → tech_lead → ... |
```

---

### TEST_GUIDE.md - 测试执行指南

**内容**:
- 测试优先级建议
- 7个场景的详细执行步骤
- 每个场景的具体命令和输入
- 关键验证点和期望结果
- 常见问题处理方案

**使用方式**:
1. 打开 TEST_GUIDE.md
2. 找到对应场景（如 "场景2"）
3. 复制 "测试命令" 区域的命令
4. 按照 "交互输入" 填写参数
5. 根据 "验证清单" 检查结果
6. 将结果记录到 TEST_REPORT.md

**特点**:
- ⚠️ 标记重点验证点
- 提供即用型命令
- 包含验证命令（git, cat, ls）

---

### DEVELOPER_SUMMARY.md - Developer 工作总结

**内容**:
- Developer Agent 完成的工作
- 测试场景概览
- P0 Bug 验证重点
- 为什么创建测试文档（而非直接执行）
- 测试执行建议
- 下一步行动建议

**适用对象**:
- Tech Lead（审核 Developer 工作）
- 用户（了解 Developer 的决策）
- 其他 Developer（参考工作方法）

---

### claude-progress03.md - 项目进度记录

**内容**:
- Tech Lead 审核记录
- Developer 工作记录
- 关键决策说明
- 测试执行建议

**用途**:
- 跟踪项目进度
- 记录 agent 之间的协作
- 保留决策依据

---

### task-dev.md / task-test.md - 测试资源

**用途**: 用于场景6测试（模式4 + .md 文件支持）

**内容**:
- task-dev.md: "请创建一个简单的问候函数"
- task-test.md: "请为问候函数编写测试"

**使用方式**:
```bash
python src/orchestrator_v6.py
# 选择: 模式4
# 输入: @developer task-dev.md && @tester task-test.md
```

---

## ✅ 测试完成标准

### 必须通过（P0）

- [ ] 场景2: 2轮循环能正常进入第2轮
- [ ] 场景2: BUG_REPORT.md 能被正确识别
- [ ] 场景4: Architect 没有越权修改源码

### 应该通过（P1）

- [ ] 场景3: 模式2 能创建 feature 分支
- [ ] 所有场景: progress.md 有完整记录

### 可选通过（P2）

- [ ] 场景1: 简单任务流程正常
- [ ] 场景5/6/7: 高级特性正常

**判断标准**:
- ✅ **全部通过**: 所有 P0 + P1 通过，至少 1 个 P2 通过
- ⚠️ **部分通过**: 所有 P0 通过，部分 P1 通过
- ❌ **失败**: 任何 P0 未通过

---

## 🔧 常见问题

### Q1: 测试时间太长，可以缩短吗？

**A**: 可以只执行 P0 和 P1 场景：
- 场景2（P0）- 20-30分钟
- 场景4（P0）- 15-20分钟
- 场景3（P1）- 10-15分钟

**总计**: 约 45-65 分钟，100k-190k tokens

### Q2: Token 预算不足怎么办？

**A**: 优先级顺序：
1. 场景4（P0，token 较少：30k-50k）
2. 场景3（P1，token 较少：20k-40k）
3. 场景2（P0，token 较多：50k-100k）

### Q3: 测试失败了怎么办？

**A**:
1. 不要立即修复代码
2. 完整记录问题现象到 TEST_REPORT.md
3. 包含：错误信息、复现步骤、期望结果、实际结果
4. 继续测试其他场景
5. 测试完成后统一分析和修复

### Q4: 可以自动化执行吗？

**A**: 当前不支持，因为：
- orchestrator_v6.py 是交互式程序
- 需要多次人工输入
- 需要实时观察输出

**解决方案**: 为 orchestrator 添加非交互模式：
```python
python src/orchestrator_v6.py \
  --account mc \
  --mode 3 \
  --rounds 2 \
  --complexity 2 \
  --task "创建一个简单的计算器程序" \
  --non-interactive
```

---

## 📊 测试执行流程图

```
开始测试
    ↓
读取 TEST_GUIDE.md
    ↓
选择场景（优先 P0）
    ↓
执行测试命令
    ↓
观察输出并验证
    ↓
记录结果到 TEST_REPORT.md
    ↓
场景完成？
    ├─ 是 → 下一个场景
    └─ 否 → 记录问题，继续下一个
    ↓
所有必选场景完成？
    ├─ 是 → 生成测试总结
    └─ 否 → 继续执行
    ↓
测试完成
```

---

## 💡 测试技巧

### 技巧1: 分批执行

不要一次性执行所有场景，建议：
- 第1批: 场景4（P0，较快）
- 第2批: 场景3（P1）
- 第3批: 场景2（P0，较慢）
- 第4批: 场景1/5/6/7（可选）

### 技巧2: 实时记录

每个场景执行完立即记录，不要等到全部完成：
```bash
# 执行场景4
python src/orchestrator_v6.py
# ...执行完成后立即...
vim TEST_REPORT.md  # 记录结果
```

### 技巧3: 保留日志

将控制台输出重定向到文件：
```bash
python src/orchestrator_v6.py 2>&1 | tee test_scenario2.log
```

### 技巧4: Git 快照

每个场景测试后创建 Git 快照：
```bash
git add -A
git stash push -m "场景2测试完成"
```

---

## 📞 获取帮助

如果遇到问题：

1. **查看 TEST_GUIDE.md** - 包含常见问题处理
2. **查看 DEVELOPER_SUMMARY.md** - 了解测试设计思路
3. **查看 PLAN.md** - 了解核心机制说明

---

**Good luck! 🚀**

测试准备工作已全部完成，现在可以开始执行测试了！
